db_create.rsx

REPORT
Create LUMENS project for
Proses LUMENS dimulai
Proses LUMENS selesai
Ringkasan Deskripsi Projek
Deskripsi Projek 
Cakupan Geografis Projek 
Data-data Acuan Dalam Projek 

Selamat datang di LUMENS!!. Anda telah berhasil menyusun konfigurasi data-data awal yang akan digunakan dalam perencanaan penggunaan lahan yang mempertimbangkan berbagai fungsi lingkungan. LUMENS project file terdiri dari dua file utama dengan akhiran .lpj dan lpd. Project file yang telah anda buat bernama

Deskripsi projek menyimpan informasi umum yang anda masukkan mengenai projek ini

Cakupan geografis projek menyimpan informasi mengenai cakupan area yang akan digunakan di dalam project, batas-batas koordinat, sistem projeksi serta resolusi spasial yang akan digunakan dalam projek

Berikut ini adalah beberapa data yang akan dijadikan data acuan dalam projek ini

Peta batas administrasi

============================================

pur_setup.rsx

Unit Perencanaan Fase 1

LUMENS-PUR Project Report
REKONSILIASI UNIT PERENCANAAN MENGGUNAKAN DATA ACUAN
Date :
Processing started :
Processing ended : 
Processing started
Processing ended
Sub-Modul PUR\n\nRekonsiliasi Unit Perencanaan

Rekonsiliasi unit perencanaan adalah proses untuk menyelesaikan tumpang-tindih ijin dengan merujuk pada peta acuan/referensi fungsi. Rekonsiliasi dilakukan dengan menganalisa kesesuaian fungsi antara data-data ijin dengan data referensi. Data ijin yang dimaksud datapat berupa data konsesi pengelolaan hutan, ijin perkebunan, ijin tambang dan lain sebagainya, Sedangkan data referensi yang digunakan dapat berupa data rencana tata ruang atau penunjukan kawasan.

DATA YANG DIGUNAKAN
Data acuan

Data acuan adalah data yang digunakan sebagai referensi dalam melakukan pengecekan kesesuaian fungsi peta-peta unit perencanaan dengan fungsi referensi. Peta ini dapat berupa peta acuan penunjukan kawasan atau peta tata ruang. Pada prinsipnya, data referensi adalah data dengan tingkat kepastian hukum tertinggi atau data yang apling dipercaya sebagai acuan fungsi unit perencanaan di sebuah daerah

Data ijin

Data ijin adalah data-data unit perencanaan yang akan digunakan untuk menunjukkan konfigurasi perencanaan penggunaan lahan di sebuah daerah. Data-data dalam bentuk peta ini menggambarkan arahan pengelolaan atau perubahan penggunaan lahan pada sebuah bagian bentang lahan

HASIL REKONSILIASI

Pada bagian ini ditunjukkan hasil proses rekonsiliasi dengan menggunakan peta referensi

DATA IJIN YANG TIDAK TERREKONSILIASI

Data ijin yang tidak dapat terekonsiliasi akan tercantum pada bagian ini. Rekonsiliasi berbasis acuan fungsi, tidak dapat dilakukan jika ditemukan dua atau lebih unit perencanaan yang memiliki kesuaian fungsi dengan data acuan/referensi. Jika hal ini terjadi maka proses rekonsiliasi harus dilanjutkan melalui diskusi dengan semau pemangku kepentingan yang terkait 


============================================

pur_reconciliation.rsx

Hasil akhir rekonsiliasi

LUMENS-PUR Project Report
REKONSILIASI UNIT PERENCANAAN MENGGUNAKAN DATA ACUAN
Date :
Processing started :
Processing ended : 

Rekonsiliasi Unit Perencanaan

Rekonsiliasi unit perencanaan adalah proses untuk menyelesaikan tumpang-tindih ijin dengan merujuk pada peta acuan/referensi fungsi. Rekonsiliasi dilakukan dengan menganalisa kesesuaian fungsi antara data-data ijin dengan data referensi. Data ijin yang dimaksud datapat berupa data konsesi pengelolaan hutan, ijin perkebunan, ijin tambang dan lain sebagainya, Sedangkan data referensi yang digunakan dapat berupa data rencana tata ruang atau penunjukan kawasan.

HASIL REKONSILIASI
Pada bagian ini ditunjukkan hasil proses rekonsiliasi dengan menggunakan peta referensi


============================================

ques_pre.rsx


PreQUES-Land Use Change Analysis for
ANALISA PERUBAHAN PENGGUNAAN LAHAN
Date :
Proses dimulai :
Proses selesai :
DATA YANG DIGUNAKAN 
HASIL ANALISA PADA TINGKAT BENTANG LAHAN 
HASIL ANALISA PADA TINGKAT UNIT PERENCANAAN
Sub-Modul Perubahan Penggunaan Lahan\n\nAnalisis Perubahan Penggunaan Lahan Periode 

Analisa perubahan tutupan lahan dilakukan untuk mengetahui kecenderungan perubahan tutupan lahan di suatu daerah pada satu kurun waktu. Analisa ini dilakukan dengan menggunakan data peta tutupan lahan pada dua periode waktu yang berbeda. Selain itu, dengan memasukkan data unit perencanaan kedalam proses analisa, dapat diketahui kecenderungan perubahan tutupan lahan pada masing-masing kelas unit perencanaan yang ada. Informasi yang dihasilkan melalui analisa ini dapat digunakan dalam proses perencanaan untuk berbagai hal. Diantaranya adalah: menentukan prioritas pembangunan, mengetahui faktor pemicu perubahan penggunaan lahan, merencanakan skenario pembangunan di masa yang akan datang, dan lain sebagainya

Data yang digunakan dalam analisa ini adalah data peta penggunaan lahan dan data peta unit perencanaan daerah. Data pendukung yang digunakan adalah peta acuan tipe penggunaan lahan dan data acuan kelas unit perencanaan
Peta Tutupan Lahan tahun

Peta Tutupan Lahan tahun

Peta Unit Perencanaan
Pada bagian ini disajikan hasil analisa perubahan penggunaan lahan untuk keseluruhan bentang lahan yang dianalisa. Beberapa bentuk analisa yang dilakukan antara lain: perbandingan luasan tutupan lahan pada periode analisa dan tipe perubahan lahan dominan pada bentang lahan yang dianalisa

Tabel Intisari Perubahan Tutupan Lahan menyajikan perbandingan luasan tipe-tipe tutupan lahan di sebuah bentnag lahan pada kurun waktu tertentu. Kolom Overall Change menunjukkan perubahan luasan dalam satuan hektar. Notasi negatif pada kolom ini menunjukkan pengurangan luasan sebaliknya notasi positif menunjukkan penambahan luasan. Kolom Rate menunjukkan laju perubahan luasan tutupan lahan dalam satuan %/tahun. Kolom ini dihitung dengan mengurangi luasan pada t2-t1 kemudian dibagi dengan perkalian luasan pada t1 dan kurun waktu analisa
Intisari Perubahan Tutupan Lahan di
20 Luasan Perubahan Tutupan Lahan (ha) di
Rerata Luasan Perubahan Tutupan Lahan (%/tahun) di
Sepuluh Perubahan Lahan Dominan di

Luas(ha)

Pada bagian ini disajikan hasil analisa perubahan penggunaan lahan untuk masing-masing kelas unit perencanaan yang dianalisa. Beberapa bentuk analisa yang dilakukan antara lain: perbandingan luasan tutupan lahan pada periode analisa dan tipe perubahan lahan dominan pada unit perencanaan yang dianalisa

20 Sepuluh Tipe Perubahan Tutupan Lahan Dominan di Unit Perencanaan 
10 Perubahan Dominan pada Unit Perencanaan"
Grafik IO: dinamika perubahan lahan di
Grafik IO: dinamika perubahan lahan di 


TRAJECTORY

Sub-Modul Perubahan Penggunaan Lahan\n\nAnalisis Alur Penggunaan Lahan Periode
PreQUES-Land Use Trajectory Analysis for 
ANALISA ALUR PENGGUNAAN LAHAN
Proses selesai :
Analisa perubahan tutupan lahan dilakukan untuk mengetahui kecenderungan perubahan tutupan lahan di suatu daerah pada satu kurun waktu. Analisa ini dilakukan dengan menggunakan data peta tutupan lahan pada dua periode waktu yang berbeda. Selain itu, dengan memasukkan data unit perencanaan kedalam proses analisa, dapat diketahui kecenderungan perubahan tutupan lahan pada masing-masing kelas unit perencanaan yang ada. Informasi yang dihasilkan melalui analisa ini dapat digunakan dalam proses perencanaan untuk berbagai hal. Diantaranya adalah: menentukan prioritas pembangunan, mengetahui faktor pemicu perubahan penggunaan lahan, merencanakan skenario pembangunan di masa yang akan datang, dan lain sebagainya.
  
ALUR PERUBAHAN PENGGUNAAN LAHAN
Alur perubahan penggunaan lahan merupakan ringkasan keseluruhan tipe rangkaian perubahan penggunaan lahan yang mungkin terjadi di sebuah daerah. Kategori besar dari alur perubahan lahan dibagi menjadi dua jenis yaitu Loss of tree cover dan recovery of tree cover
Gambar 1. Peta Kelompok Perubahan Penutupan Lahan Tahun
Gambar 2. Grafik Kelompok Perubahan Penutupan Lahan Tahun
Gambar 3. Grafik Kelompok Perubahan Penutupan Lahan Tahun berdasarkan Unit Perencanaan
Tabel 1. Luas Area Kelompok Perubahan Penutupan Lahan Tahun
Tabel 2. Luas Area Kelompok Perubahan Lahan di Tahun Tiap Unit Perencanaan 
Sub Gambar Grafik Perubahan Lahan di Berbagai Zona Perencanaan untuk jenis Tahun 

PERUBAHAN TUTUPAN HUTAN
Salah satu bentuk alur perubahan penggunaan lahan yang paling banyak mendapatkan perhatian adalah alur perubahan hutan alam menjadi tipe tutupan lahan lainnya (deforestasi) dan perubahan hutan alam primer menjadi hutan alam sekunder (degradasi). Bagian ini memperlihatkan hasil analisa LUMENS terhadap perubahan tutupan hutan di sebuah daerah

Gambar 4. Grafik Perubahan Tutupan Hutan di Berbagai Zona Perencanaan Tahun berdasarkan Unit Perencanaan
Tabel 3. Luas deforestasi Tahun 
Tabel 4. Luas deforestasi berdasarkan zonasi Tahun
Tabel 5. Laju deforestasi berdasarkan zonasi Tahun
Jenis perubahan tutupan hutan
Luas area (Ha)
Sub Gambar Grafik Perubahan Hutan di Berbagai Zona Perencanaan untuk Tahun
Gambar 5. Grafik Perubahan Tutupan Hutan dan alur perubahan yang menyebabkannya berdasarkan Unit Perencanaan
Tabel 5. Luas deforestasi berdasarkan alur perubahan Tahun 


============================================

ques_carbon.rsx

fs_cat<-c("Period", "Total area", "Total Emisi (Ton CO2-eq)", "Total Sequestrasi (Ton CO2-eq)", "Emisi Bersih (Ton CO2-eq)", "Laju Emisi (Ton CO2-eq/tahun)","Laju emisi per-unit area (Ton CO2-eq/ha.tahun)")
colnames(fs_table)<-c("ID", "Kategori", "Ringkasan")
colnames(zone_carbon_pub) <- c("ID", "Luas (Ha)", "Tutupan lahan", "Total emisi (Ton CO2-eq)", "Total sekuestrasi(Ton CO2-eq)", "Emisi bersih (Ton CO2-eq)", "Laju emisi (Ton CO2/Ha.yr)")
colnames(admin_carbon_pub) <- c("ID", "Luas (Ha)", "Wil. Administratif", "Total emisi (Ton CO2-eq)", "Total sekuestrasi(Ton CO2-eq)", "Emisi bersih (Ton CO2-eq)", "Laju emisi (Ton CO2/Ha.yr)")
colnames(data_zone_pub) <- c("ID", "Luas (Ha)", "Unit Perencanaan", "Rerata Karbon Periode 1", "Rerata Karbon Periode 2", "Emisi bersih", "Laju emisi")


Kerapatan karbon
Emisi (ton CO2-eq)
Sequestrasi (ton CO2-eq)

Rerata Kerapatan Karbon
Rerata Kerapatan Karbon
Rerata laju emisi
Rerata laju sequestrasi
Rerata laju emisi bersih

HASIL ANALISIS 
Modul QUES-C - Analisis Dinamika Cadangan Karbon
ANALISIS DINAMIKA CADANGAN KARBON
Date :
Proses dimulai :
Proses selesai :
DATA YANG DIGUNAKAN 
ANALISIS PADA TINGKAT BENTANG LAHAN 
ANALISIS PADA TINGKAT UNIT PERENCANAAN 

Sub-Modul Karbon\n\nAnalisis Dinamika Cadangan Karbon\n Periode 

Analisis dinamika cadangan karbon dilakukan untuk perubahan cadangan karbon di suatu daerah pada satu kurun waktu. Metode yang digunakan adalah metode Stock Difference. Emisi dihitung sebagai jumlah penurunan cadangan karbon akibat perubahan tutupan lahan terjadi apabila cadangan karbon awal lebih tinggi dari cadangan karbon setelah terjadinya perubahan penggunaan lahan. Sebaliknya, sequestrasi dihitung sebagai jumlah penambahan cadangan karbon akibat perubahan tutupan lahan (cadangan karbon pada penggunaan lahan awal lebih rendah dari cadangan karbon setelah terjadinya perubahan penggunaan lahan).. Analisis ini dilakukan dengan menggunakan data peta tutupan lahan pada dua periode waktu yang berbeda dan tabel acuan kerapatan karbon untuk masing-masing tipe tutupan lahan. Selain itu, dengan memasukkan data unit perencanaan kedalam  analisis, dapat diketahui tingkat perubahan cadangan karbon pada masing-masing kelas unit perencanaan yang ada. Informasi yang dihasilkan melalui analisis ini dapat digunakan dalam proses perencanaan untuk berbagai hal, diantaranya menentukan prioritas aksi mitigasi perubahan iklim, mengetahui faktor pemicu terjadinya emisi, dan merencanakan skenario pembangunan di masa yang akan datang.

Data yang digunakan dalam analisis ini adalah data peta penggunaan lahan dan data peta unit perencanaan daerah. Data pendukung yang digunakan adalah peta acuan tipe penggunaan lahan, data acuan kerapatan karbon masing-masing tipe tutupan lahan dan data acuan kelas unit perencanaan.

Peta penutupan lahan tahun 
Peta penutupan lahan tahun 
Peta unit perencanaan 
Peta wilayah administratif 
Pada bagian ini disajikan hasil analisis dinamika cadangan karbon untuk keseluruhan bentang lahan yang dianalisis. Beberapa bentuk analisis yang dilakukan antara lain: tingkat emisi, tingkat sequestrasi, laju emisi dan tipe perubahan penggunaan lahan yang paling banyak menyebabkan emisi/sequestrasi.

Peta kerapatan karbon tahun (dalam Ton C/Ha)
Peta kerapatan karbon tahun (dalam Ton C/Ha)
Peta emisi karbon tahun 
Peta penyerapan karbon

Intisari perhitungan emisi
Intisari perhitungan emisi per unit perencanaan
Intisari perhitungan emisi per wilayah administrasi

Keterangan :
Emisi bersih = Total emisi - Total sequestrasi
Laju emisi = (Total Emisi - Total Sequestrasi) / (luas * periode waktu)

Sumber Emisi Terbesar
Sumber sequestrasi terbesar

Pada bagian ini disajikan hasil analisis dinamika cadangan karbon untuk masing-masing kelas unit perencanaan yang dianalisis. Beberapa bentuk analisis yang dilakukan antara lain: tingkat emisi, tingkat sequestrasi, laju emisi dan tipe perubahan penggunaan lahan yang paling banyak menyebabkan emisi/sequestrasi.

Sumber Emisi terbesar pada 
Sumber Sequestrasi Terbesar Pada 


============================================

ta_re_singleio_descriptive.rsx

LUMENS-Trade-off Analysis (TA) Project Report
Sub-modules 2: Regional economic-Descriptive analysis (Single I-O)
Date : 
Processing started :
Processing ended :
1.Analysis of Sectoral Linkages
2.Analysis of GDP 
Total GDP 
2.Analysis of multiplier 

Sub-Modul Ekonomi Regional\n\nAnalisis Deskriptif Sektor Ekonomi\n Tahun

Table 1. Sectoral linkages
Figure 1. Ten sectors with highest Backward power of dispersion
Figure 2. Ten sectors with highest Forward power of dispersion
Figure 3. Sectoral typology based on linkages analysis
Table 2. Primary sectors based on potential linkage
Table 3. Sectoral GDP
Figure 4. Twenty sectors with highest GDP
Table 4. Sectoral multiplier
Figure 5. Twenty sectors with highest Output multiplier
Figure 6. Twenty sectors with highest Income multiplier
Figure 7. Twenty sectors with highest Labour multiplier



============================================

ques_biodiv.rsx



Laporan Proyek LUMENS-QUES
Sub-modul: Analisis Biodiversitas
Tanggal :
Proses dimulai :
Proses selesai : 
chapter1<-"\\b\\fs28 1. DATA INPUT\\b0\\fs28"
chapter2<-"\\b\\fs28 2. PERUBAHAN AREA FOKAL\\b0\\fs28"
chapter3<-"\\b\\fs28 3. DISTRIBUSI NILAI IKTT\\b0\\fs28"
chapter4<-"\\b\\fs28 4. \\i DEGREE OF INTEGRATION OF FOCAL AREA\\i0  (\\i DIFA\\i0 )\\b0\\fs28"
chapter5<-"\\b\\fs28 5. DINAMIKA IKTT DAN AREA FOKAL\\b0\\fs28"
chapter6<-"\\b\\fs28 6. DESKRIPSI IKTT UNIT PERENCANAAN\\b0\\fs28"

text_submodule <- paste("Sub-Modul Keanekaragaman Hayati\n\nAnalisis Biodiversitas Bentang Lahan\n", location_rpt, ", ", "Periode ", pd_1, "-", pd_2, sep="")

# ==== Report 0.2 Preface ====
addNewLine(rtffile)
text <- paste0("\\qj Dokumen ini dihasilkan dari penjalanan modul \\i Quantification of Ecosystem Services - Biodiversity (QUES-B) \\i0 dalam perangkat lunak LUMENS. Sistematika laporan ini adalah: pengantar yang memuat prinsip dasar analisis terdapat di bagian ini, informasi mengenai data-data yang digunakan pada bagian 1, sedangkan bagian 2 - 6 memuat intisari luaran analisis modul  \\i QUES-B\\i0 . Pada setiap bagian terdapat petunjuk singkat yang disediakan demi kemudahan pengguna dalam menginterpretasi informasi dan/atau data yang ditampilkan.")
addParagraph(rtffile, text)
addNewLine(rtffile, n = 1)
text <- paste0("\\qj Analisis dalam modul \\i QUES-B \\i0 bertujuan untuk memberi gambaran mengenai aspek biodiversitas suatu daerah di tingkat lanskap. Kerangka kerja yang diadopsi mengacu pada metode penelitian yang telah dipublikasikan oleh Dewi, dkk. pada tahun 2013. Sebelum proses dijalankan, pengguna menentukan kelas-kelas tutupan lahan alami yang paling merepresentasikan habitat bagi keanekaragaman hayati asli suatu lanskap. Berdasarkan peta tutupan lahan multi waktu, dinamika kondisi tutupan alami dianalisis dalam modul \\i QUES-B \\i0 sehingga dihasilkan beberapa besaran yang mengindikasikan perubahan luas dan konfigurasi tutupan alami di suatu daerah studi. Peralihan tutupan lahan yang berkontribusi terhadap dinamika kondisi tutupan alami dan luasannya dapat diketahui berdasarkan luaran modul ini. Selain itu, informasi mengenai perubahan luas dan konfigurasi tutupan alami suatu daerah disajikan secara kuantitatif dalam indeks tunggal yang disebut \\i Degree of Integration of Focal Area (DIFA)\\i0 . Indeks yang ringkas sekaligus indikatif ini akan membantu pemangku kepentingan yang harus mempertimbangan banyak aspek dalam analisis kebijakan pengelolaan lahan, khususnya dalam memperkirakan implikasi suatu keputusan terhadap kelestarian biodiversitas suatu daerah. Informasi kewilayahan juga turut melengkapi luaran modul ini untuk membantu proses dialog dan kolaborasi antar pemangku kepentingan dalam perencanaan dan pengelolaan daerah yang memperhatikan kelestarian keanekaragaman hayati.")
addParagraph(rtffile, text)
addNewLine(rtffile, n = 0.5)
addNewLine(rtffile, n = 1)
#==== Report I. DATA INPUT ====
addHeader(rtffile, chapter1, TOC.level = 1)
addNewLine(rtffile, n = 1.5)
text <- paste0("\\qj Analisis dalam modul \\i QUES-B \\i0 dijalankan berdasarkan masukan data berupa tabel dan peta. Tabel yang diperlukan antara lain tabel bobot kontras tepi (\\i edge contrast weight\\i0) yang memuat angka derajat perbedaan antara suatu kelas tutupan lahan terhadap kelas lainnya dalam memfasilitasi keberadaan biodiversitas asli dari area fokal. Peta tutupan lahan serta peta unit perencanaan adalah data-data spasial yang menjadi masukan utama dalam analisis. Peta tutupan lahan digunakan sebagai dasar dari penghitungan luas dan konfigurasi spasial area fokal dalam daerah studi. Penggunaan peta tutupan lahan pada dua titik waktu membuat analisis dinamika area fokal antar waktu dapat dilakukan. Pemahaman mengenai hubungan erat antara subjek pengelolaan kawasan yang beragam dengan kondisi area fokal suatu daerah melatarbelakangi pelibatan peta unit perencanaan dalam tahap penyajian hasil analisis. ")
addParagraph(rtffile, text)
addNewLine(rtffile)
text <- paste0("\\qj Pada bagian ini ditampilkan data-data spasial yang digunakan sebagai masukan dalam analisis. Analisis mencakup daerah seluas ", prettyNum(round(sum(area_lc1$count)*Spat_res, digits = 2), big.mark = ".", decimal.mark = ","), " hektar. Tutupan lahan pada daerah analisis digolongkan dalam ", nrow(lulc_lut), " kelas seperti yang ditampilkan pada peta. Selain itu, terdapat ", nrow(lookup_z.area), " unit perencanaan yang menunjukkan tipologi kawasan pengelolaan.")
addParagraph(rtffile, text)
addPageBreak(rtffile, width = 8.267, height = 11.692, omi = c(1,1,1,1))
text <- paste0("\\b Peta Tutupan Lahan \\b0", area_name_rep,"  \\b tahun \\b0", I_O_period_1_rep)
addParagraph(rtffile, text)
addNewLine(rtffile, n=1)
addPlot.RTF(rtffile, plot.fun=print, width=6.27, height=4, res=150, plot.LU1 )
#rm(plot.LU1)
text <- paste0("\\b Peta Tutupan Lahan \\b0", area_name_rep, "  \\b tahun \\b0", I_O_period_2_rep)
addParagraph(rtffile, text)
addNewLine(rtffile, n=1)
addPlot.RTF(rtffile, plot.fun=print, width=6.27, height=4, res=150, plot.LU2 )
addPageBreak(rtffile, width = 8.267, height = 11.692, omi = c(1,1,1,1))
#rm(plot.LU2)
text <- paste("\\b Peta Unit Perencanaan\\b0 ", area_name_rep, sep=" ")
addParagraph(rtffile, text)
addNewLine(rtffile, n=1)
addPlot.RTF(rtffile, plot.fun=print, width=6.27, height = (4 + 0.24 + round(nrow(lookup_z.area)/2, digits = 0)*0.14), res=150, plot.Z )
#rm(plot.Z)
addNewLine(rtffile, n=1)
text <- paste0("\\b Kelas tutupan lahan yang dijadikan sebagai area fokal: ", names(fa_class[p]), "\\b0")
addParagraph(rtffile, text)
addNewLine(rtffile, n = 0.5)
addNewLine(rtffile, n = 1)
#==== Report II. Focal Area Changes ====
addHeader(rtffile, chapter2, TOC.level = 1)
addNewLine(rtffile, n=1.5)
text <- paste0("\\qj Dalam \\i QUES-B \\i0 digunakan istilah area fokal yang didefinisikan sebagai kelas tutupan lahan yang mewakili habitat bagi keanekaragaman hayati asli suatu daerah dalam kondisi primer. Suatu daerah studi dapat saja memiliki lebih dari satu jenis area fokal namun proses analisis dilangsungkan secara unik per area fokal. Dalam analisis dinamika area fokal, modul \\i QUES-B \\i0 memperhitungkan tak hanya luas namun juga konfigurasi spasialnya. Dengan kata lain, konektifitas dan diskonektifitas antara petak-petak area fokal mempengaruhi luaran analisis \\i QUES-B\\i0. ")
addParagraph(rtffile, text)
addNewLine(rtffile)
text <- paste0("\\qj Bagian ini memuat informasi mengenai perubahan luas area fokal dan perubahan tutupan lahan yang berkaitan. Luas perubahan tutupan lahan dan area fokal terdampak serta statistik lanskap dasar yang mendeskripsikan kondisi umum area fokal secara kuantitatif tersaji dalam bentuk tabel. Selain itu, peta area fokal pada dua titik waktu yang berbeda juga ditampilkan untuk memberikan gambaran visual mengenai dimensi spasial dari dinamika yang terjadi. Pada tabel kedua sebelum terakhir ditunjukkan dinamika luas area fokal pada setiap unit perencanaan serta proporsi relatif luas area fokal terdampak terhadap luas total unit perencanaan (dalam %). ")
addParagraph(rtffile, text)
addNewLine(rtffile)
text <- paste0("\\qj Dalam analisis \\i QUES-B \\i0 secara keseluruhan terdapat ", length(fa_class), " kelas tutupan lahan yang didefinisikan sebagai area fokal. Laporan ini membahas secara spesifik satu kelas tutupan area fokal, yaitu ", names(fa_class[p]), ". Pada kondisi utuh yang didefinisikan berdasarkan peta tutupan lahan tahun ", pristine_pd, ", ", names(fa_class[p]), " mencakup area seluas ", prettyNum(round(totarea*Spat_res, digits = 2), big.mark = ".", decimal.mark = ","), " hektar. Pada tahun ", pd_1, " dan ", pd_2, " luas area fokal yang tersisa adalah ", prettyNum(round(area_lc1[area_lc1$CLASS_LC1 == names(fa_class[p]), "count"]*Spat_res, digits = 2), big.mark = ".", decimal.mark = ","), " hektar (", round(area_lc1[area_lc1$CLASS_LC1 == names(fa_class[p]), "count"]/totarea*100, digits = 2),"%) dan ", prettyNum(round(area_lc2[area_lc2$CLASS_LC2 == names(fa_class[p]), "count"]*Spat_res, digits = 2), big.mark = ".", decimal.mark = ","), " hektar (", round(area_lc2[area_lc2$CLASS_LC2 == names(fa_class[p]), "count"]/totarea*100, digits = 2), "%), secara berurutan. Dengan kata lain, selama ", pd_2-pd_1, " tahun terdapat perubahan luas area fokal sebesar ", prettyNum(round(area_lc2[area_lc2$CLASS_LC2 == names(fa_class[p]), "count"]*Spat_res - area_lc1[area_lc1$CLASS_LC1 == names(fa_class[p]), "count"]*Spat_res, digits = 2), big.mark = ".", decimal.mark = ","), " hektar atau sebanding dengan ", round(abs(100*(area_lc2[area_lc2$CLASS_LC2 == names(fa_class[p]), "count"]*Spat_res - area_lc1[area_lc1$CLASS_LC1 == names(fa_class[p]), "count"]*Spat_res)/(area_lc1[area_lc1$CLASS_LC1 == names(fa_class[p]), "count"]*Spat_res)), digits = 2), "% dari luas pada tahun ", pd_1, ".")
addParagraph(rtffile, text)
if(maxValue(chk_loss)>0) {
addNewLine(rtffile)
text <- paste("\\b Peta Kelenyapan Area Fokal \\b0", area_name_rep, "  \\b periode \\b0", I_O_period_1_rep, "\\b -\\b0 ", I_O_period_2_rep,  sep="")
addParagraph(rtffile, text)
addPlot.RTF(rtffile, plot.fun=print, width=6.27, height=4, res=150, plot.FAC.loss )
addNewLine(rtffile, n=1)
text <- paste("\\b Tutupan Lahan Terasosiasi dengan Kelenyapan Area Fokal \\b0",area_name_rep, " \\b periode \\b0", I_O_period_1_rep, "\\b -\\b0", I_O_period_2_rep,  sep=" ")
addParagraph(rtffile, text)
addTable(rtffile, id.col_rm(foc.area.loss.att), font.size = 9, col.justify = c("L", "R", "R"), header.col.justify = c("L", "R", "R"))
addParagraph(rtffile, "\\b\\fs20 *Besaran area dalam hektar; Proporsi dalam persen(%)\\b0\\fs20 ")
addNewLine(rtffile, n=1)
} else {
print("Tidak ditemukan kelenyapan area fokal")
}

if(maxValue(chk_gain)>0) {
if(maxValue(chk_loss)>0){
addPageBreak(rtffile, width = 8.267, height = 11.692, omi = c(1,1,1,1))
} else addNewLine(rtffile, n=1)
text <- paste("\\b Peta Kemunculan Area Fokal \\b0", area_name_rep, "  \\b periode \\b0", I_O_period_1_rep, "\\b -\\b0 ", I_O_period_2_rep,  sep="")
addParagraph(rtffile, text)
addPlot.RTF(rtffile, plot.fun=print, width=6.27, height=4, res=150, plot.FAC.gain )
addNewLine(rtffile, n=1)
text <- paste("\\b Tutupan Lahan Sebelum Kemunculan Area Fokal\\b0 ",area_name_rep,  " \\b periode \\b0", I_O_period_1_rep,'\\b -\\b0',I_O_period_2_rep,  sep=" ")
addParagraph(rtffile, text)
addTable(rtffile, id.col_rm(foc.area.gain.att), font.size = 9, col.justify = c("L", "R", "R"), header.col.justify = c("L", "R", "R"))
addParagraph(rtffile, "\\b\\fs20 *Besaran area dalam hektar; Proporsi dalam persen(%)\\b0\\fs20 ")
addNewLine(rtffile, n=1)
} else {
print("Tidak ditemukan kemunculan area fokal")
}

# description of the planning units associated with focal area change
# planning unit with the highest change
# define textif1
if(zstat.foc.area$foc.area.change[1] < 0){
textif1 <- paste0(zstat.foc.area$Legend[1], " adalah unit perencanaan dengan alih fungsi area fokal terbesar (", prettyNum(round(abs(zstat.foc.area$foc.area.change[1]), digits = 2), big.mark = ".", decimal.mark = ","), " hektar)")
} else{
textif1 <- ""
}
if(nchar(textif1)!=0) textcon <- ", sedangkan" else textcon <- ""
if(zstat.foc.area$foc.area.change[nrow(zstat.foc.area)] > 0){
textif2 <- paste0("pemulihan area fokal terbesar terdapat di unit perencanaan ", zstat.foc.area$Legend[nrow(zstat.foc.area)], " (", prettyNum(round(abs(zstat.foc.area$foc.area.change[nrow(zstat.foc.area)]), digits = 2), big.mark = ".", decimal.mark = ","), " hektar)")
} else {
textif2 <- ""
}
if(nchar(textcon) == nchar(textif2)){
textsubs <- "tidak ditemukan unit perencanaan yang berasosiasi dengan perubahan luas area fokal"
} else textsubs <- ""
text <- paste0("\\qj Berdasarkan lokasi terjadinya konversi dari atau menjadi kelas tutupan area fokal, diketahui bahwa ", textif1, textcon, textif2, textsubs, ".")
addParagraph(rtffile, text)
addNewLine(rtffile, n=1)
# Table pu focal area change
text <- paste("\\b Perubahan Area Fokal pada Unit Perencanaan\\b0 ",area_name_rep, " \\b periode \\b0", I_O_period_1_rep,'\\b -\\b0',I_O_period_2_rep,  sep=" ")
addParagraph(rtffile, text)
names(zstat.foc.area) <- c("ZONE", "Kawasan", "Luas Perubahan", "Luas Wilayah", "Proporsi Luas") # INDO ver
addTable(rtffile, id.col_rm(zstat.foc.area), font.size = 9, col.justify = c('L', 'R', 'R', 'R'), header.col.justify = c('L', 'R', 'R', 'R'))
addParagraph(rtffile, "\\b\\fs20 *Besaran area dalam hektar; Proporsi dalam persen(%)\\b0\\fs20 ")
addNewLine(rtffile, n=1)
text <- paste("\\b Statistik Lanskap Dasar\\b0 ")
addParagraph(rtffile, text)
addTable(rtffile, foc.area.stats, row.names=TRUE, font.size = 9, col.justify = c('L', 'R', 'R'), header.col.justify = c('L', 'R', 'R'))
addParagraph(rtffile, "\\b\\fs20 *Besaran area dalam hektar;Panjang dalam meter; Proporsi dalam persen(%)\\b0\\fs20 ")
addNewLine(rtffile, n = 0.5)
addNewLine(rtffile, n = 1)
#==== Report III.  Map of dissimilarities from focal area====
addHeader(rtffile, chapter3, TOC.level = 1)
addNewLine(rtffile, n=1.5)
text <- paste0("\\qj Derajat perbedaan antara sebidang area fokal dengan kelas tutupan non fokal yang bersebelahan mempengaruhi sifat tepi, terutama permeabilitasnya (kemampuan tepi untuk meloloskan perpindahan individu spesies, materi, dll. dari area fokal). Bidang area fokal dengan ukuran, bentuk, dan konfigurasi yang sama dikatakan lebih rentan terhadap ancaman terhadap keanekaragaman hayatinya apabila tepinya bersebelahan langsung degan kelas-kelas pentutupan lahan yang derajat perbedaannya tinggi dibandingkan dengan kelas yang derajat perbedaannya rendah. Hal ini dibangun berdasarkan anggapan bahwa tepi area fokal yang berbatasan secara langsung dengan kelas yang memiliki kontras tinggi akan memiliki permeabilitas yang lebih rendah dan berlaku pula sebaliknya.")
addParagraph(rtffile, text)
addNewLine(rtffile)
text <- paste0("\\qj Modul \\i QUES-B \\i0 menghitung estimasi permeabilitas suatu petak area fokal berdasarkan indeks kontras tepi total (IKTT atau \\i Total Edge Contrast Index\\i0, disingkat \\i TECI\\i0) pada tingkat sub-lanskap. Sub-lanskap ditentukan berdasarkan 'jendela bergerak' (\\i moving window\\i0) yang mengikhtisarkan indeks kontras tepi total pada area sub-lanskap yang berpusat pada setiap piksel area fokal. Pendekatan matematis yang diterapkan dalam peringkasan nilai indeks kontras tepi total dalam 'jendela bergerak' adalah perata-rataan. Adapun dimensi 'jendela bergerak', yakni ukuran dan bentuknya, diatur oleh pengguna pada jendela input. ")
addParagraph(rtffile, text)
addNewLine(rtffile)
text <- paste0("\\qj Rentang nilai IKTT adalah nol hingga 100. Nilai IKTT nol menunjukkan kenihilan kontras antara suatu sel area fokal dengan petak-petak di sekitarnya, sedangkan nilai seratus terasosiasi dengan kondisi di mana area fokal sangat berbeda dengan piksel yang mengelilinginya (contoh: area fokal berupa kelas tutupan hutan primer yang 'dikepung' oleh area terbangun). Perlu diperhatikan bahwa tinggi rendahnya tingkat perbedaan suatu kelas tutupan lahan terhadap tutupan area fokal ditentukan berdasarkan nilai bobot kontras tepi yang dijadikan sebagai salah satu masukan modul ini (lihat bagian I). ")
addParagraph(rtffile, text)
addNewLine(rtffile)
text <- paste0("\\qj Proses penghitungan IKTT dilakukan secara spasial sehingga dihasilkan peta yang menunjukkan distribusi nilai pada daerah studi. Satu titik waktu diwakili oleh satu peta IKTT seperti yang ditampilkan di bawah ini. Perubahan nilai IKTT yang umum teramati dalam analisis antarwaktu antara lain: penambahan, pengurangan, kemunculan, dan kelenyapan. Perubahan-perubahan tersebut merupakan dampak dari perubahan tutupan lahan suatu daerah pada suatu titik waktu ke titik waktu setelahnya terutama yang mempengaruhi luas dan distribusi area fokal dan/atau area di sekitarnya. Pemahaman lebih mendalam mengenai perubahan-perubahan IKTT serta interpretasinya terdapat pada bagian 5. ")
addParagraph(rtffile, text)
addPageBreak(rtffile, width = 8.267, height = 11.692, omi = c(1,1,1,1))
text <- paste("\\b Peta Distribusi Nilai IKTT \\b0 ",area_name_rep, " \\b  tahun \\b0", I_O_period_1_rep, sep="")
addParagraph(rtffile, text)
addPlot.RTF(rtffile, plot.fun=print, width=6.27, height=4, res=150, plot.mw.init )
addNewLine(rtffile, n=1)
text <- paste("\\b Peta Distribusi Nilai IKTT \\b0 ",area_name_rep, " \\b  tahun \\b0", I_O_period_2_rep, sep="")
addParagraph(rtffile, text)
addPlot.RTF(rtffile, plot.fun=print, width=6.27, height=4, res=150, plot.mw.fin )
addPageBreak(rtffile, width = 8.267, height = 11.692, omi = c(1,1,1,1))

#==== Report IV.  DIFA Chart ====
addHeader(rtffile, chapter4, TOC.level = 1)
addNewLine(rtffile, n=1.5)
text <- paste0("\\qj Informasi mengenai luas dan distribusi area fokal serta nilai IKTT suatu daerah memiliki tingkat spesifisitas dan kedetilan yang tinggi. Kenyataan bahwa terdapat banyak sekali faktor lain yang perlu diperhatikan (misalnya: legalitas, ekonomi, dan sosial) dalam proses pengelolaan dan perencanaan daerah serta keberagaman tingkat pemahaman para pemangku kepentingan terkait isu habitat dan lingkungan hidup, informasi-informasi terkait kondisi area fokal perlu dikemas secara ringkas dan padat. Untuk menjawab kebutuhan tersebut, telah dikembangkan suatu indeks numerik yang disebut sebagai \\i DIFA \\i0 (singkatan dari \\i Degree of Integration of Focal Area\\i0).")
addParagraph(rtffile, text)
addNewLine(rtffile)
text <- paste0("\\qj Penghitungan indeks \\i DIFA \\i0 dilakukan setelah peta nilai IKTT suatu daerah dihasilkan. Suatu mekanisme peringkasan nilai IKTT dan luasan area fokal diterapkan dengan bantuan unit pengagregasi berupa poligon-poligon persegi yang mencakup seluruh area studi. Luas area fokal dan rataan seluruh nilai IKTT dari area yang tercakup setiap persegi dihitung dan diasosiasikan dengan ID unik dari masing-masing unit pengagregasi tersebut. Kemudian, dilakukan penyusunan catatan teragregasi berdasarkan nilai IKTT dari masing-masing ID unit dari kecil ke besar. Unit-unit dengan nilai IKTT yang sama diintegrasi sehingga diperoleh luasan total area fokal yang terasosiasi dengan nilai-nilai IKTT yang ada. Angka luasan total area fokal dikonversi menjadi nilai persentase relatif terhadap luasan total area fokal pada masa ketika luasan area fokal diasumsikan utuh dan belum terpengaruhi manusia secara signifikan. Setelah itu, dibuat kurva antara nilai kumulatif persentase area fokal (sumbu y) terhadap nilai IKTT (sumbu x). Hasil pembagian luas area di bawah kurva dengan angka 100 adalah nilai \\i DIFA \\i0 daerah studi pada suatu titik waktu. ")
addParagraph(rtffile, text)
addNewLine(rtffile)
text <- paste0("\\qj Berbeda dengan nilai IKTT, peningkatan nilai \\i DIFA \\i0 mengindikasikan kondisi area fokal yang semakin ideal. Besarnya nilai \\i DIFA \\i0 dipengaruhi oleh beberapa faktor seperti: luas total, konfigurasi dan distribusi spasial area fokal pada titik waktu tertentu serta kontras area fokal dengan area di sekitarnya. Persentase total area fokal menentukan batas maksimal nilai \\i DIFA \\i0 pada suatu titik waktu, sedangkan nilai IKTT yang menunjukkan kontras area fokal dengan wilayah sekitarnya mempengaruhi kelerengan kurva kumulatif yang dihasilkan. Dengan demikian, dapat disimpulkan bahwa nilai \\i DIFA \\i0 yang tinggi berasosiasi dengan daerah berarea fokal luas dan terintegrasi. ")
addParagraph(rtffile, text)
addNewLine(rtffile)
# text <- paste0("\\qj Kurva nilai kumulatif persentase area fokal yang diproyeksikan terhadap nilai IKTT serta hasil penghitungan nilai \\i DIFA \\i0 ditampilkan pada bagian di bawah ini. ")
# addParagraph(rtffile, text)
# addNewLine(rtffile)
# Dynamic text describing DIFA value change over time
# conditional analysis: increase or decrease of DIFA value
if(AUC.init < AUC.final){
textif1 <- "terjadi peningkatan"
textif2 <- paste0(" sebesar ", round(abs(AUC.init - AUC.final), digits = 2), " %")
} else if(AUC.init > AUC.final){
textif1 <- "terjadi penurunan"
textif2 <- paste0(" sebesar ", round(abs(AUC.init - AUC.final), digits = 2), " %")
} else{
textif1 <- "tidak terjadi perubahan"
textif2 <- ""
}
# text
text <- paste0("\\qj Kurva nilai kumulatif persentase area fokal yang diproyeksikan terhadap nilai IKTT serta hasil penghitungan nilai \\i DIFA \\i0 ditampilkan pada bagian di bawah ini. Pada tahun ", pd_1, " nilai indeks \\i DIFA \\i0 ", location_rpt, " adalah sebesar ", AUC.init, ". Dalam periode ", pd_2-pd_1, " tahun, ", textif1, " nilai \\i DIFA\\i0 ", textif2, ".")
addParagraph(rtffile, text)
# allowing the curve to be located in neat position on the next page
addPageBreak(rtffile, width = 8.267, height = 11.692, omi = c(1,1,1,1))
text <- paste("\\b Kurva \\i Degree of Integration of Focal Area (DIFA)\\b0")
addParagraph(rtffile, text)
addNewLine(rtffile, n=0.5)
addPlot.RTF(rtffile, plot.fun=print, width=6.27, height=3, res=150, grid.arrange(difa.init, difa.final, ncol=2))
addNewLine(rtffile, n=1)
text <- paste("\\b Nilai Indeks \\i DIFA\\b0")
addParagraph(rtffile, text)
text <- paste(I_O_period_1_rep, " : ", AUC.init, "%", "          ;    " ,I_O_period_2_rep, " : ", AUC.final, "%", sep=" ")
addParagraph(rtffile, text)
addNewLine(rtffile, n = 0.5)
addNewLine(rtffile, n = 1)
#==== Report V.  Habitat Change Analysis ====
addHeader(rtffile, chapter5, TOC.level = 1)
addNewLine(rtffile, n=1.5)
text <- paste0("\\qj Perubahan indeks \\i DIFA \\i0 dipengaruhi oleh perubahan nilai IKTT dan luas area fokal yang terjadi dalam konteks yang sangat beragam. Pemahaman mengenai konteks-konteks tersebut dapat didekati melalui pengenalan status dan letak kawasan perencanaan tempat terjadinya perubahan nilai IKTT dan/atau luas area fokal. Seperti yang telah dituliskan sebelumnya, secara umum dinamika nilai IKTT dan luas area fokal dapat digolongkan menjadi peningkatan atau penurunan nilai IKTT serta kelenyapan dan kemunculan nilai IKTT sebagai dampak dari konversi tutupan lahan dari/menjadi kelas tutupan area fokal.")
addParagraph(rtffile, text)
addNewLine(rtffile)
text <- paste0("\\qj Di awal bagian ini ditampilkan sebuah grafik yang menunjukkan keseluruhan ID unit agregasi (lihat bagian 4) dalam koordinat kartesian berupa nilai IKTT pada titik waktu terdahulu sebagai posisi x dan IKTT pada titik waktu terkini sebagai posisi Y. Luasan lingkaran menunjukkan luas area fokal pada masing-masing unit agregasi di setiap titik waktu; setiap titik waktu diwakili oleh warna lingkaran yang berbeda. Perbedaan luas lingkaran yang berpusat pada titik yang sama mengindikasikan terjadinya perubahan luas area fokal dalam periode yang diamati. Lingkaran-lingkaran yang berada di atas garis acuan diagonal merupakan unit agregasi tempat teramatinya peningkatan nilai IKTT, sementara lingkaran yang berada di bawah garis tersebut menunjukkan fenomena sebaliknya. ID unit agregasi yang mengalami kelenyapan atau kemunculan nilai IKTT ditampilkan pada pojok atas atau kanan grafik (melampaui nilai 100), secara berurutan.")
addParagraph(rtffile, text)
addNewLine(rtffile)
text <- paste0("\\qj Di bawah grafik tersebut, terdapat peta yang menampilkan poligon agregasi untuk menunjukkan letak unit-unit agregasi pada daerah studi. Dengan mencocokkan nama titik dalam grafik terhadap indeks peta, pengguna dapat memetakan perkiraan lokasi terjadinya fenomena-fenomena yang mempengaruhi nilai \\i DIFA \\i0 suatu daerah. Informasi lebih lengkap mengenai bentuk perubahan tutupan lahan yang menyebabkan perubahan nilai IKTT dan kawasan yang terasosiasi disampaikan pada sub-bagian-sub-bagian berikutnya dalam bentuk peta dan tabel.")
addParagraph(rtffile, text)
addPageBreak(rtffile, width = 8.267, height = 11.692, omi = c(1,1,1,1))
# summary plot
text <- paste("\\b Grafik Dinamika Nilai IKTT dan Area Fokal \\b0 ",area_name_rep, "  \\b periode \\b0", I_O_period_1_rep, "\\b -\\b0 ", I_O_period_2_rep,  sep="")
addParagraph(rtffile, text)
addPlot.RTF(rtffile, plot.fun=print, width=6.27, height=5, res=150, teci_fa_dyn.plot)
addPageBreak(rtffile, width = 8.267, height = 11.692, omi = c(1,1,1,1))
text <- paste("\\b Peta Unit Agregasi \\b0",  sep="")
addParagraph(rtffile, text)
addPlot.RTF(rtffile, plot.fun=print, width=6.27, height=5, res=150, ag_map)
addNewLine(rtffile, n=1)
subch_num <- 0
tryCatch({
plot.HD
luchg.db.degrad
subch_num <- subch_num + 1
text <- paste("\\b\\fs24 ", subch_num, ". Peningkatan Nilai IKTT \\b0\\fs24 ", gsub("22", "24", area_name_rep), "  \\b\\fs24 periode \\b0\\fs24", gsub("22", "24", I_O_period_1_rep), "\\b\\fs24 -\\b0\\fs24 ", gsub("22", "24", I_O_period_2_rep),  sep="")
addParagraph(rtffile, text)
addPlot.RTF(rtffile, plot.fun=print, width=6.27, height=3, res=150, plot.HD)
addNewLine(rtffile, n=1)
text <- paste("\\b 10 Tipologi Peningkatan Nilai IKTT Terluas berdasarkan Unit Perencanaan dan Perubahan Tutupan Lahan Terkait\\b0 ", sep="")
addParagraph(rtffile, text)
addTable(rtffile, id.col_rm(luchg.db.degrad[1:10,]), font.size = 9, col.justify = c('L', 'L', 'R'), header.col.justify = c('L', 'L', 'R'))
}, error=function(e){cat("Melewatkan analisis peningkatan nilai IKTT:",conditionMessage(e), "\n")})
addNewLine(rtffile, n=1)

tryCatch({
if(maxValue(chk_loss)>0) {
plot.HL
luchg.db.loss
subch_num <- subch_num + 1
text <- paste("\\b\\fs24 ", subch_num, ". Kelenyapan Nilai IKTT \\b0\\fs24 ",gsub("22", "24", area_name_rep), "  \\b\\fs24 periode \\b0\\fs24", gsub("22", "24", I_O_period_1_rep), "\\b\\fs24 -\\b0\\fs24 ", gsub("22", "24", I_O_period_2_rep),  sep="")
addParagraph(rtffile, text)
addPlot.RTF(rtffile, plot.fun=print, width=6.27, height=3, res=150, plot.HL)
addNewLine(rtffile, n=1)
text <- paste("\\b 10 Tipologi Kelenyapan Nilai IKTT Terluas berdasarkan Unit Perencanaan dan Perubahan Tutupan Lahan Terkait\\b0 ", sep="")
addParagraph(rtffile, text)
addTable(rtffile, id.col_rm(luchg.db.loss[1:10,]), font.size = 9, col.justify = c('L', 'L', 'R'), header.col.justify = c('L', 'L', 'R'))
# addNewLine(rtffile, n=1)
} else { 
print("Tidak ditemukan kelenyapan nilai IKTT")
}
}, error=function(e){cat("Melewatkan analisis kelenyapan nilai IKTT:",conditionMessage(e), "\n")})
addNewLine(rtffile, n=1)

tryCatch({
plot.HR
luchg.db.recovery # may contain zero row, therefore, extra line below is added
if(nrow(luchg.db.recovery) == 0)luchg.db.recovery$induce_error<- 0
subch_num <- subch_num + 1
if(subch_num ==3) addPageBreak(rtffile, width = 8.267, height = 11.692, omi = c(1,1,1,1))
text <- paste("\\b\\fs24 ", subch_num, ". Penurunan Nilai IKTT \\b0\\fs24 ",gsub("22", "24", area_name_rep), "  \\b\\fs24 periode \\b0\\fs24", gsub("22", "24", I_O_period_1_rep), "\\b\\fs24 -\\b0\\fs24 ", gsub("22", "24", I_O_period_2_rep),  sep="")
addParagraph(rtffile, text)
addPlot.RTF(rtffile, plot.fun=print, width=6.27, height=3, res=150, plot.HR)
addNewLine(rtffile, n=1)
text <- paste("\\b 10 Tipologi Penurunan Nilai IKTT Terluas berdasarkan Unit Perencanaan dan Perubahan Tutupan Lahan Terkait\\b0 ", sep="")
addParagraph(rtffile, text)
addTable(rtffile, id.col_rm(luchg.db.recovery[1:10,]), font.size = 9, col.justify = c('L', 'L', 'R'), header.col.justify = c('L', 'L', 'R'))
# addNewLine(rtffile, n=1)
}, error=function(e){cat("Melewatkan analisis penurunan nilai IKTT:",conditionMessage(e), "\n")})
addNewLine(rtffile, n=1)

tryCatch({
if(maxValue(chk_gain)>0) {
plot.HG
luchg.db.gain
subch_num <- subch_num + 1
if(subch_num ==3) addPageBreak(rtffile, width = 8.267, height = 11.692, omi = c(1,1,1,1))
text <- paste("\\b\\fs24 ", subch_num, ". Kemunculan Nilai IKTT \\b0\\fs24 ",gsub("22", "24", area_name_rep), "  \\b\\fs24 periode \\b0\\fs24", gsub("22", "24", I_O_period_1_rep), "\\b\\fs24 -\\b0\\fs24 ", gsub("22", "24", I_O_period_2_rep),  sep="")
addParagraph(rtffile, text)
if (maxValue(chk_gain)>0) {
  addPlot.RTF(rtffile, plot.fun=print, width=6.27, height=3, res=150, plot.HG)
} else { 
  print('Melewatkan analisis kemunculan nilai IKTT') 
}
addNewLine(rtffile, n=1)
text <- paste("\\b 10 Tipologi Kemunculan Nilai IKTT Terluas berdasarkan Unit Perencanaan dan Perubahan Tutupan Lahan Terkait\\b0 ", sep="")
addParagraph(rtffile, text)
addTable(rtffile, id.col_rm(luchg.db.gain[1:10,]), font.size = 9, col.justify = c('L', 'L', 'R'), header.col.justify = c('L', 'L', 'R'))
} else {
print("Tidak ditemukan kemunculan nilai IKTT")
}
}, error=function(e){cat("Melewatkan analisis kemunculan nilai IKTT:",conditionMessage(e), "\n")})
#==== XXX Report VI.  Habitat Quality Comparison XXX ====
#addHeader(rtffile, chapter6)
addNewLine(rtffile, n = 0.5)
addNewLine(rtffile, n = 1)
#tryCatch({
#text <- paste("\\b\\fs20 Habitat Quality Comparison in\\b0\\fs20 ",area_name_rep, "  ", I_O_period_1_rep, "\\b\\fs20 -\\b0\\fs20 ", I_O_period_2_rep,  sep="")
#addParagraph(rtffile, text)
#addPlot.RTF(rtffile, plot.fun=print, width=6.27, height=4, res=150, grid.arrange(plot.hb.chg.init, plot.hb.chg.final, ncol=2) )
#addNewLine(rtffile, n=1)
#addTable(rtffile, habitat.change)
#addNewLine(rtffile, n=1)
#},error=function(e){cat("skipping Habitat Quality Comparison analysis:",conditionMessage(e), "\n")})
#addNewLine(rtffile, n=1)
#==== Report VI.  TECI Zonal Statistics ====
addHeader(rtffile, chapter6, TOC.level = 1)
addNewLine(rtffile, n=1.5)
text <- paste0("\\qj Analisis dinamika kondisi area fokal seringkali memerlukan tindak lanjut berupa dialog dengan pemangku kepentingan, misalnya untuk perencanaan dan implementasi suatu aksi intervensi seperti restorasi atau konservasi. Identifikasi pemangku kepentingan yang paling sesuai dengan isu pengelolaan kondisi area fokal dapat dibantu dengan ketersediaan informasi mengenai profil kawasan dari waktu ke waktu. Sehubungan dengan hal tersebut, pada bagian ini ditampilkan hasil penghitungan statistika deskriptif perubahan nilai IKTT pada masing-masing kawasan pengelolaan/unit perencanaan. Informasi disajikan dalam dua tabel: tabel pertama memuat informasi mengenai kenaikan nilai IKTT sedangkan tabel berikutnya mengenai penurunan nilai IKTT. Informasi tambahan berupa perubahan luas area fokal di setiap kawasan pengelolaan turut ditampilkan untuk membantu interpretasi dinamika riil yang terjadi.")
addParagraph(rtffile, text)
addNewLine(rtffile)
tryCatch({
text <- paste("\\b Profil Unit Perencanaan: Kenaikan nilai IKTT \\b0 ",area_name_rep, "  \\b periode \\b0", I_O_period_1_rep, "\\b -\\b0 ", I_O_period_2_rep,  sep="")
addParagraph(rtffile, text)
addTable(rtffile, id.col_rm(zstat.habitat.degradation), font.size = 9, col.justify = c('L', 'R', 'R', 'R', 'R', 'R', 'R'), header.col.justify = c('L', 'R', 'R', 'R', 'R', 'R', 'R'))
addParagraph(rtffile, "\\b\\fs20 *Maks, min, rerata, dan SD merupakan deskripsi numerik dari peningkatan nilai IKTT\\b0\\fs20 ")
addParagraph(rtffile, "\\b\\fs20 *Luas perubahan (area fokal) dalam hektar\\b0\\fs20 ")
addNewLine(rtffile, n=1)

text <- paste("\\b Profil Unit Perencanaan: Penurunan nilai IKTT \\b0 ",area_name_rep, "  \\b periode \\b0", I_O_period_1_rep, "\\b -\\b0 ", I_O_period_2_rep,  sep="")
addParagraph(rtffile, text)
addTable(rtffile, id.col_rm(zstat.habitat.recovery), font.size = 9, col.justify = c('L', 'R', 'R', 'R', 'R', 'R', 'R'), header.col.justify = c('L', 'R', 'R', 'R', 'R', 'R', 'R'))
addParagraph(rtffile, "\\b\\fs20 *Maks, min, rerata, dan SD merupakan deskripsi numerik dari penurunan nilai IKTT\\b0\\fs20 ")
addParagraph(rtffile, "\\b\\fs20 *Luas perubahan (area fokal) dalam hektar\\b0\\fs20 ")
addNewLine(rtffile, n=1)
}, error=function(e){cat("Melewatkan analisis profil unit perencanaan:",conditionMessage(e), "\n")})
addNewLine(rtffile, n=1)
done(rtffile)